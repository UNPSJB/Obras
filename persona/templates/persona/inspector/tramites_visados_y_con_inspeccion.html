{% load staticfiles %}
{% block contenido %}
<div class="table-responsive">
    <table class="table table-bordered table-striped table-hover table-condensed" style="background: white;">
        <thead>
            <tr>
                <th class="col-sm-1">Nro de tramite</th>
                <th>Propietario</th>
                <th>Profesional</th>
                <th>Medidas</th>
                <th>Tipo de Obra</th>
                <th>Estado</th>
                <th> Fecha de inspeccion</th>
                <th>Agendar</th>
            </tr>
        </thead>
        <tbody>
            {% if tramites %}
                {% for tramite in tramites %}
                    <tr>
                        <td>{{ tramite.id }}</td>
                        <td>{{ tramite.propietario }}</td>
                        <td>{{ tramite.profesional }} </td>
                        <td>{{ tramite.medidas }}</td>
                        <td>{{ tramite.tipo_obra }}</td>
                        <td>{{ tramite.estado }}</td>
                        <td>
                            <input type="hidden" id="id{{tramite.id}}" value="{{tramite.id}}">
                            <input id="datetime{{tramite.id}}" type="date" value="" >
                            <input id="time{{tramite.id}}" type="time" value="">
                        </td>
                        <td>

                        <script type="text/javascript">
                        function agregarHoraInspeccion{{tramite.id}}(){
                            var id_tramite = $("#id{{tramite.id}}").val();
                            var date = $("#datetime{{tramite.id}}").val();
                            var hora= $("#time{{tramite.id}}").val();
                            if (date  && hora) {
                                var fecha = date+' '+hora;
                                url = '/persona/agendar_tramite/'+id_tramite+'/?msg='+fecha;
                                location.href = url;
                            }
                            else if (hora ==''){
                                alert ("El campo hora es obligatorio");
                            }else{
                                if(date===''){
                                    alert("El campo fecha es obligatorio");
                                }
                                else{
                                    alert("Los campos fecha y hora son obligatorios");
                                }
                             }
                            return false;
                        }
                        </script>
                            <a onclick="javascript:agregarHoraInspeccion{{tramite.id}}();">
                              <button type="button" class="btn btn-primary btn-sm" name="Agendar">Agendar
                              </button>
                            </a>
                        </td>
                    </tr>


                {% endfor %}
            {% endif%}
        </tbody>
    </table>
</div>
{% endblock %}
